$(document).ready(function(){function a(b,c){$(b).children("li").each(function(b,d){var e="";for(var f=0;f<c;f++){e+="      "}e+=$(d).children("a").text();$("#responsive-main-nav-menu").append("<option value = '"+$(d).children("a").attr("href")+"'>"+e+"</option>");if($(d).children("ul").size()==1){a($(d).children("ul"),c+1)}})}function b(a,b){var c=new Object;c.innerWidth=$(b).data("width")||false;c.innerHeight=$(b).data("height")||false;c.slideshow=String($(b).data("slideshow")).toLowerCase()=="true";c.slideshowAuto=String($(b).data("slideshowauto")).toLowerCase()=="true";c.iframe=String($(b).data("iframe")).toLowerCase()=="true";c.inline=String($(b).data("inline")).toLowerCase()=="true";c.photo=String($(b).data("photo")).toLowerCase()=="true";c.rel=$(b).data("group");c.fixed=true;if(!$(b).is("a"))c.href=$(b).data("href");if(!c.innerWidth)c.innerWidth=c.iframe?480:false;if(!c.innerHeight)c.innerHeight=c.iframe?360:false;c.maxWidth="100%";c.maxHeight="100%";c.speed=600;c.opacity=.75;c.current="{current} / {total}";c.onComplete=function(){if(!$("#colorbox").data("isInitiated")){$("#colorbox").data("isSlideshow",$("#cboxSlideshow").css("display")!="none");$("#colorbox").data("isSingle",$("#cboxNext").css("display")=="none")}else{if($("#colorbox").data("mouseOver")==false){$("#cboxNext").hide();$("#cboxPrevious").hide();$("#cboxSlideshow").hide();$("#cboxClose").hide()}}if($("#colorbox").data("isInitiated")){return}$("#colorbox").hover(function(){$("#colorbox").data("mouseOver",true);$("#cboxClose").fadeIn(150);if(!$("#colorbox").data("isSingle")){$("#cboxNext").fadeIn(150);$("#cboxPrevious").fadeIn(150)}if($("#colorbox").data("isSlideshow")){$("#cboxSlideshow").fadeIn(150)}},function(){$("#colorbox").data("mouseOver",false);$("#cboxClose").fadeOut(150);if(!$("#colorbox").data("isSingle")){$("#cboxNext").fadeOut(150);$("#cboxPrevious").fadeOut(150)}if($("#colorbox").data("isSlideshow")){$("#cboxSlideshow").fadeOut(150)}});$("#colorbox").data("isInitiated",true)};c.onCleanup=function(){$("#colorbox").data("isInitiated",false)};$(b).colorbox(c)}function f(a,b){var c=jQuery("<div>");jQuery.each(b,function(a){var b=jQuery(this).clone();jQuery(b).removeClass("first");if(a%d==0)jQuery(b).addClass("first");b.appendTo(c)});var e=jQuery("<li>",{html:a,data:{list:c}});e.addClass("tab").appendTo("#portfolio-filter > ul")}function g(){var a=$(".sticky-nav").eq(0);if(!a.parent().offset())return;var b=a.parent().offset().top-20;var c=a.parent().children(".entry").size()>1?a.parent().children(".entry").last().offset().top-20:a.parent().height()-a.height()+a.parent().offset().top;var d=$(window).scrollTop();if(d>b&&d<c){a.css({position:"fixed",top:20,left:a.parent().offset().left-100})}else if(d>=c){a.css({position:"absolute",top:c-b,left:-100})}else{a.css({position:"absolute",top:0,left:-100})}}function h(a,b){var c=false;var d=9e10;var e=$(a).offset().top;if(b=="prev")d*=-1;$(a).parent().children(".entry").each(function(a){if(b=="next"){if($(this).offset().top-e>10&&$(this).offset().top-e<d){d=$(this).offset().top-e;c=$(this).offset().top-20}}else{if($(this).offset().top-e<-10&&$(this).offset().top-e>d){d=$(this).offset().top-e;c=$(this).offset().top-20}}});return c}if($.cookie("ts-hide-banner")=="1"){$("#announcement").hide()}else{$("#announcement").show()}$("#announcement .close-announcement").click(function(){$("#announcement").slideUp(500,"easeInOutQuad");$.cookie("ts-hide-banner","1",{path:"/"});return false});a($("#main-nav-menu > ul"),0);$("#main-nav-menu").find("li:has(ul) > a").each(function(){$(this).append("<span class = 'indicator'/>")});$("#main-nav-menu").find("li:has(ul)").hover(function(){var a=$(this).children("ul");a.hide();a.fadeIn(250)},function(){$(this).children("ul").hide()});$("body").append("<div title = 'Back to Top' class = 'page-top-link back-to-top'><a href = '#'>Return to top</a></div>");$(".divider a, .page-top-link").click(function(){$(window.opera?"html":"html, body").stop(true,true).animate({scrollTop:0},1500,"easeInOutQuad");return false});$("input[type='text'],textarea").each(function(){var a=$(this).data("prompt");if(a==undefined)return;$(this).val(a).data("original-value",a);if($(this).val()==a)$(this).addClass("js-original");$(this).focusin(function(){if($(this).val()==$(this).data("original-value"))$(this).val("");$(this).removeClass("js-original")});$(this).focusout(function(){if($(this).val()==""){$(this).val($(this).data("original-value"));$(this).addClass("js-original")}})});$(".tab").each(function(){if(!$(this).hasClass("active")){$(this).parent().next().find(".tab-body:nth-child("+($(this).index()+1)+")").hide()}$(this).click(function(){if(!$(this).hasClass("active")){$(this).parent().find(".tab").removeClass("active");$(this).addClass("active");$(this).parent().next().find(".tab-body").hide();$(this).parent().next().find(".tab-body:nth-child("+($(this).index()+1)+")").fadeIn();return false}})});$(".toggle-title").each(function(){if(!$(this).parent().hasClass("active")){$(this).next().hide()}$(this).click(function(){$(this).next().slideToggle(Math.min(600,Math.max(300,$(this).next().height())));$(this).parent().toggleClass("active");return false})});$(".accordion-panel-title").each(function(){if(!$(this).parent().hasClass("active")){$(this).next().hide()}$(this).click(function(){if($(this).next().is(":hidden")){$(this).parent().parent().find(".accordion-panel-title").next().slideUp(Math.min(600,Math.max(300,$(this).next().height()))).parent().removeClass("active");$(this).next().slideDown(Math.min(600,Math.max(300,$(this).next().height()))).parent().toggleClass("active")}return false})});$(".flexslider").flexslider({directionNav:false,controlNav:true,pauseOnAction:false,pauseOnHover:true,animation:"fade",animationDuration:150,start:function(a){var b=$("<div class = 'controls right-nav'></div>");var c=$("<a class = 'next'>Next</a>");var d=$("<a class = 'prev'>Prev</a>");var e=a.find(".flex-control-nav");b.append(d).append(c);a.append(b);c.click(function(){a.flexAnimate(a.getTarget("next"))});d.click(function(){a.flexAnimate(a.getTarget("prev"))});var f=b.clone(true).removeClass("right-nav").addClass("left-nav").appendTo(a);var g=f.find("a.next");b.prepend(c);e.appendTo(b).after(e.prev());d.stop(true,true).css({"margin-right":-d.outerWidth()-40,opacity:0});g.stop(true,true).css({"margin-left":-d.outerWidth()-40,opacity:0});e.stop(true,true).css({"margin-right":-e.outerWidth()-40,opacity:0});b.hover(function(){d.stop(true,true).animate({"margin-right":0,opacity:1},250);var a=$(this).find(".flex-control-nav");if(a.length==0){a=$(this).next().find(".flex-control-nav");a.appendTo(this).after(a.prev())}a.stop(true,true).css({"margin-right":-a.outerWidth()-40,opacity:0,"margin-left":"auto"}).animate({"margin-right":0,opacity:1},250)},function(){d.stop(true,true).animate({"margin-right":-d.outerWidth()-40,opacity:0},300,"easeInOutQuad");var a=$(this).find(".flex-control-nav");a.stop(true,true).css("margin-left","auto").animate({"margin-right":-a.outerWidth()-40,opacity:0},300,"easeInOutQuad")});f.hover(function(){g.stop(true,true).animate({"margin-left":0,opacity:1},250);var a=$(this).find(".flex-control-nav");if(a.length==0){a=$(this).prev().find(".flex-control-nav");a.appendTo(this).after(a.prev())}a.stop(true,true).css({"margin-left":-a.outerWidth()-40,opacity:0,"margin-right":"auto"}).animate({"margin-left":0,opacity:1},250)},function(){g.stop(true,true).animate({"margin-left":-g.outerWidth()-40,opacity:0},300,"easeInOutQuad");var a=$(this).find(".flex-control-nav");a.stop(true,true).css("margin-right","auto").animate({"margin-left":-a.outerWidth()-40,opacity:0},300,"easeInOutQuad")})}});$(".flexslider.autohide .controls").hide();$(".flexslider.autohide").hover(function(){$(this).find(".controls").css("display","block").children("a").stop(true,true).fadeIn(150)},function(){$(this).find(".controls").css("display","block").children("a").stop(true,true).fadeOut(150)});$(".colorbox").each(b);$("audio,video").mediaelementplayer();$(".twitter-feed").each(function(){var a=$(this).html().replace(/%7B/g,"{").replace(/%7D/g,"}");$(this).html("");$(this).social({network:"twitter",loadingText:"Loading...",user:$(this).attr("data-user"),count:3,twitter:{output:String(a)}})});$(".flickr-feed").each(function(){var a=$(this).html().replace(/%7B/g,"{").replace(/%7D/g,"}");$(this).html("");$(this).social({network:"flickr",loadingText:"Loading...",user:$(this).attr("data-user"),count:9,flickr:{output:String(a)}})});$(".contact-form").each(function(){var a=$(this);a.find("*[type='submit']").click(function(){var b=a.find("input[name='name']");var c=a.find("input[name='email']");var d=a.find("textarea[name='message']");var e=a.find("textarea[name='website']");c.removeClass("invalid");a.parent().find(".form-failure").hide();if(b.val()==b.attr("data-prompt")||b.val()==""){b.focus();return false}if(c.val()==c.attr("data-prompt")||c.val()==""){c.focus();return false}if(c.val().indexOf("@",0)==-1||c.val().indexOf(".",0)==-1){c.focus();c.addClass("invalid");return false}if(d.val()==d.attr("data-prompt")||d.val()==""){d.focus();return false}var f="name="+b.val()+"&email="+c.val()+"&message="+d.val();if(e)f+="website="+e.val();$.ajax({type:"POST",url:a.attr("action"),data:f,success:function(e){if(e=="missing_name"){b.focus()}else if(e=="missing_email"){c.focus()}else if(e=="missing_message"){d.focus()}else if(e=="invalid_email"){c.focus();c.addClass("invalid")}else if(e=="success"){a.hide();a.parent().find(".form-success").fadeIn(500)}else if(e=="failure"){a.parent().find(".form-failure").fadeIn(500)}},error:function(b){a.parent().find(".form-failure").fadeIn(500)}});return false})});var c={};var d=4;if(jQuery("#portfolio.filterable").hasClass("portfolio-3"))d=3;if(jQuery("#portfolio.filterable").hasClass("portfolio-2"))d=2;var e=jQuery("#portfolio.filterable .span-"+12/d);e.each(function(a){var b=jQuery(this),e=b.data("tags").split(",");b.attr("data-id",a);jQuery(b).removeClass("first");if(a%d==0)jQuery(b).addClass("first");jQuery.each(e,function(a,d){d=jQuery.trim(d);if(!(d in c)){c[d]=[]}c[d].push(b)})});f("All",e);jQuery.each(c,function(a,b){f(a,b)});jQuery("#portfolio-filter li").on("click",function(a){var c=jQuery(this);c.addClass("active").siblings().removeClass("active");jQuery("#portfolio.filterable > div").quicksand(c.data("list").find(".span-"+12/d),{adjustHeight:jQuery("#portfolio.filterable").data("s")?"dynamic":"auto",easing:"easeInOutQuad",duration:750,useScaling:true,enhancement:function(){jQuery("#portfolio.filterable .colorbox").each(b);if(window.ie_overlay)jQuery(".overlay").each(ie_overlay)}});a.preventDefault()});jQuery("#portfolio-filter li:first").click();jQuery("#portfolio.filterable").data("s",true);$(".portfolio.compact .entry .more").click(function(){var a=$(this).closest(".entry");$(".portfolio.compact .entry").not(a).removeClass("active");a.toggleClass("active");$(".portfolio.compact .entry").each(function(a,b){var c,d,e,f,g;c=$(b).find(".entry-wrap");d=c.find(".entry-feature");if($(b).hasClass("active")==true){e=d.outerHeight();f=.2;g=Math.max($(c).height(),$(c).height()-$(this).find(".entry-feature").outerHeight()+$(this).find(".entry-content").outerHeight()+30)}else{e=0;f=1;g=$(c).height()}if($(b).data("ts")=="1"){d.stop(true,true).animate({opacity:f},600,"easeInOutQuad");c.find(".entry-content").stop(true,true).animate({opacity:f==1?0:1},f==1?500:800,"easeInOutQuad");c.stop(true,true).animate({top:-e},600,"easeInOutQuad");$(this).stop(true,true).animate({height:g},200,"easeInOutQuad")}});return false});top.updateCompactPortfolioEntry=function(a){var b=$(a).closest(".entry");var c=b.find(".entry-wrap");var d=b.find(".entry-feature").outerHeight();c.find(".entry-content").css("opacity",0);$(c).height(d+b.find("header").outerHeight()+30);b.height($(c).height());b.data("ts","1")};$(".portfolio.compact .entry").each(function(){var a=$(this).find(".entry-feature img");if(a.size()>0){var b=a[0];if(b.complete){top.updateCompactPortfolioEntry(b)}else{$(b).attr("onload","top.updateCompactPortfolioEntry(this);")}}else{var c=$(this).find(".entry-feature iframe");c=c[0];top.updateCompactPortfolioEntry(c)}});$(".sticky-nav").fadeIn(200);$(".sticky-nav .next, .sticky-nav .prev").click(function(){var a=h($(this).parent(),$(this).hasClass("next")?"next":"prev");if(a!==false)$(window.opera?"html":"html, body").stop(true,true).animate({scrollTop:a},1e3,"easeInOutQuad");return false});$(".blog .leave-a-comment, .blog .leave-a-comment-text").click(function(){$(window.opera?"html":"html, body").stop(true,true).animate({scrollTop:$(".blog #comment-form").offset().top-20},1e3,"easeInOutQuad");return false});$(window).scroll(function(){if($(window).scrollTop()>150){$(".back-to-top").stop(true,true).fadeIn(200)}else{$(".back-to-top").stop(true,true).fadeOut(200)}g()});$(window).scroll();$(window).resize(g)})